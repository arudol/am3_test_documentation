<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Code overview &#8212; AM3 test documentation 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=cb25574f" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Physics processes details: swichtes and options for speed optimization" href="processes_details.html" />
    <link rel="prev" title="Installing pyAM3" href="installAM3.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="code-overview">
<h1>Code overview<a class="headerlink" href="#code-overview" title="Link to this heading">¶</a></h1>
<p>To evolve number densities $n$ as a function of time $t$ AM3 solves the time-dependent partial differential equations of the form</p>
<p>$$ \partial_{t}n(E,t)=-\partial_{E} \dot{E}({E,t})n(E,t)-\alpha(E,t) n(E,t)+Q(E,t) $$</p>
<p>It thus accounts for cooling [ $\dot{E}(E,t)$ ], escape/sink [ $\alpha(E,t)$ ] and injection/source [ $Q(E,t)$  ].</p>
<section id="code-structure">
<h2>Code structure<a class="headerlink" href="#code-structure" title="Link to this heading">¶</a></h2>
<p>The user-interface module is split in a few classes:</p>
<ul class="simple">
<li><p>‘SimulationManager’ is the core class holding a single simulation. Objects of this class will be referred to as ‘sim’.</p></li>
<li><p>‘PhysicsHandler’ is the physics manager, a helper class to collect all physics processes. It does not have to be accessed, only initialisation is required. Objects of this class will be referred to as ‘ph’.</p></li>
<li><p>‘RunParams’ holds the parameters of the simulation, such as the source details. Objects of this class will be referred to as ‘rp’.</p></li>
<li><p>‘AM3Arrays’ holds the data arrays during the simulation. It does not have to be accessed, only initialisation is required. Objects of this class will be referred to as ‘dat’</p></li>
<li><p>‘IO’ contains the input/output possibilities. Objects of this class will be referred to as ‘io’.</p></li>
</ul>
</section>
<section id="run-settings-grids">
<h2>Run settings: Grids<a class="headerlink" href="#run-settings-grids" title="Link to this heading">¶</a></h2>
<p>Code-internal we differentiate between three energy grids: The lepton ($e^\pm$), photon ($\gamma$) and hadronic (all other particles) ones; all equally spaced in logarithmic space (base e). The grid settings are specified during compilation and thus cannot be changed during runtime.
Grid parameters and access:</p>
<ul class="simple">
<li><p><em>Definition of energy grids</em> is done in include/AM3/global_defs.h .
Photon grid length is defined by BIN_X, photon grid origin X_I. The other grid lengths are derived: BIN_E = BIN_X + X_I, BIN_P = BIN_E - 26. Grid spacing D_X = 0.1 (in e base) is not be changed, as this would lead to erroneous results.</p></li>
<li><p><em>Readout of grids</em> is via object io of class IO:</p>
<ol class="arabic simple">
<li><p>Grid parameters: <code class="docutils literal notranslate"><span class="pre">io.dlnE()</span></code> [Grid spacing in ln-space], <code class="docutils literal notranslate"><span class="pre">io.NLepE()</span></code> [number of electron grid points], <code class="docutils literal notranslate"><span class="pre">io.NLepG()</span></code> [number of photon grid points], <code class="docutils literal notranslate"><span class="pre">io.NHad()</span></code> [number of hadronic grid points], <code class="docutils literal notranslate"><span class="pre">io.NNU()</span></code> [number of neutrino grid points]</p></li>
<li><p>Grids in eV: <code class="docutils literal notranslate"><span class="pre">io.E_LepE_eV()</span></code> [array of electron grid], <code class="docutils literal notranslate"><span class="pre">io.E_LepG_eV()</span></code> [array of photon grid], <code class="docutils literal notranslate"><span class="pre">io.E_Had_eV()</span></code> [array of hadronic grid], <code class="docutils literal notranslate"><span class="pre">io.E_Nu_eV()</span></code> [array of neutrino grid]</p></li>
<li><p>For conversion of energy in eV to gridpoint, users may rely on <code class="docutils literal notranslate"><span class="pre">io.EeV2i_LepE()</span></code> / <code class="docutils literal notranslate"><span class="pre">io.EeV2i_LepG()</span></code> / <code class="docutils literal notranslate"><span class="pre">io.EeV2i_Had()</span></code> / <code class="docutils literal notranslate"><span class="pre">io.EeV2i_Nu()</span></code></p></li>
</ol>
</li>
</ul>
<p>In contrast to the energy grid, the time step may be adjusted dynamically and is accessible through the parameter “dt” of the class RunParams, thus <code class="docutils literal notranslate"><span class="pre">rp.dt</span></code> (in s).</p>
</section>
<section id="particle-species">
<h2>Particle species<a class="headerlink" href="#particle-species" title="Link to this heading">¶</a></h2>
<p>The code calculates the time-dependent evolution of the following species:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Particle</p></th>
<th class="head"><p>Symbol</p></th>
<th class="head"><p>Internal name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Electrons</p></td>
<td><p>$e^-$</p></td>
<td><p>LepE</p></td>
</tr>
<tr class="row-odd"><td><p>Positrons</p></td>
<td><p>$e^+$</p></td>
<td><p>LepP</p></td>
</tr>
<tr class="row-even"><td><p>Photons</p></td>
<td><p>$\gamma$</p></td>
<td><p>LepG</p></td>
</tr>
<tr class="row-odd"><td><p>Protons</p></td>
<td><p>$p$</p></td>
<td><p>HadP</p></td>
</tr>
<tr class="row-even"><td><p>Neutrons</p></td>
<td><p>$n$</p></td>
<td><p>HadN</p></td>
</tr>
<tr class="row-odd"><td><p>Left-handed muons</p></td>
<td><p>$\mu^-_L$</p></td>
<td><p>MmL</p></td>
</tr>
<tr class="row-even"><td><p>Right-handed muons</p></td>
<td><p>$\mu^-_R$</p></td>
<td><p>MmR</p></td>
</tr>
<tr class="row-odd"><td><p>Left-handed anti-muons</p></td>
<td><p>$\mu^+_L$</p></td>
<td><p>MpL</p></td>
</tr>
<tr class="row-even"><td><p>Right-handed anti-muons</p></td>
<td><p>$\mu^+_R$</p></td>
<td><p>MpR</p></td>
</tr>
<tr class="row-odd"><td><p>Positive pions</p></td>
<td><p>$\pi^+$</p></td>
<td><p>Pip</p></td>
</tr>
<tr class="row-even"><td><p>Negatie pions</p></td>
<td><p>$\pi^-$</p></td>
<td><p>Pim</p></td>
</tr>
<tr class="row-odd"><td><p>Muon neutrinos</p></td>
<td><p>$\nu_{\mu}$</p></td>
<td><p>Num</p></td>
</tr>
<tr class="row-even"><td><p>Muon anti-neutrinos</p></td>
<td><p>$\bar{\nu}_\mu$</p></td>
<td><p>NumA</p></td>
</tr>
<tr class="row-odd"><td><p>Electon neutrinos</p></td>
<td><p>$\nu_e$</p></td>
<td><p>Nue</p></td>
</tr>
<tr class="row-even"><td><p>Election anti-neutrinos</p></td>
<td><p>$\bar{\nu}_e$</p></td>
<td><p>NueA</p></td>
</tr>
</tbody>
</table>
<section id="accessing-the-particle-distributions">
<h3>Accessing the particle distributions<a class="headerlink" href="#accessing-the-particle-distributions" title="Link to this heading">¶</a></h3>
<p>Access is implemented through the IO class (with corresponding object io):</p>
<ul>
<li><p>The particle species can be accessed through get/set functions: <br />
The scheme for getters is</p>
<blockquote>
<div><p>io.Edn_dE_ + ${Internal name} + ()</p>
</div></blockquote>
<p>For example <code class="docutils literal notranslate"><span class="pre">io.Edn_dE_LepE()</span></code>. For setting with an array input_array use</p>
<blockquote>
<div><p>io.set_Edn_dE_ + ${Internal name} + (input_array)</p>
</div></blockquote>
<p>For example <code class="docutils literal notranslate"><span class="pre">io.set_Edn_dE_LepE(input_array)</span></code>.
Units are 1/cm$^3$ for all.</p>
</li>
<li><p>Collecting <em>all</em> particles of a species: <br />
Neutrinos may be read out as all-flavour array through <code class="docutils literal notranslate"><span class="pre">io.Edn_dE_Nu()</span></code></p></li>
<li><p>Photons by emitting process: \</p></li>
</ul>
</section>
</section>
<section id="source-parameters">
<h2>Source parameters<a class="headerlink" href="#source-parameters" title="Link to this heading">¶</a></h2>
</section>
<section id="physics-processes">
<h2>Physics processes<a class="headerlink" href="#physics-processes" title="Link to this heading">¶</a></h2>
<p>The following physics processes are included:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Process</p></th>
<th class="head"><p>Abbreviation</p></th>
<th class="head"><p>Terms entering the differential equations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Synchrotron</p></td>
<td><p>sy</p></td>
<td><p>$Q_\gamma$, $\alpha_\gamma$, $\dot{E}$ for all charged particles</p></td>
</tr>
<tr class="row-odd"><td><p>Inverse Compton</p></td>
<td><p>ic</p></td>
<td><p>$Q_\gamma$, $\alpha_\gamma$, $\dot{E}$ for all charged particles</p></td>
</tr>
<tr class="row-even"><td><p>Photo-pair production</p></td>
<td><p>bh</p></td>
<td><p>$\dot{E}<em>p$, $Q</em>{e^{\pm}}$</p></td>
</tr>
<tr class="row-odd"><td><p>Photo-pion production</p></td>
<td><p>pg</p></td>
<td><p>$\alpha_{\gamma}$, $\alpha_p$, $Q_{\pi^\pm}$, $Q_\gamma$</p></td>
</tr>
<tr class="row-even"><td><p>Adiabatic expansion</p></td>
<td><p>ad</p></td>
<td><p>$\alpha$ for all particles, $\dot{E}$ for all charged particles</p></td>
</tr>
<tr class="row-odd"><td><p>Escape</p></td>
<td><p>es</p></td>
<td><p>$\alpha$ for all particles</p></td>
</tr>
<tr class="row-even"><td><p>Pion decay</p></td>
<td><p>dec</p></td>
<td><p>$\alpha_{\pi^\pm}$, $Q_{\mu^\pm}$, $Q_{\nu_\mu}$</p></td>
</tr>
<tr class="row-odd"><td><p>Muon decay</p></td>
<td><p>dec</p></td>
<td><p>$\alpha_{\mu^\pm}$, $Q_{e^\pm}$, $Q_{\nu_\mu}$, $Q_{\nu_e}$</p></td>
</tr>
<tr class="row-even"><td><p>Injection</p></td>
<td><p>inj</p></td>
<td><p>$Q_{e^{-}}$, $Q_p$</p></td>
</tr>
</tbody>
</table>
<p><strong>Notes</strong>: (1) Due to their short lifetime, neutral pions are assumed to decay instantaneously. We hence don’t list a neutral pion but a photon source term for photo-pion production. (2) Injection here refers to the build-in injection. Arbitrary injection is possible by passing arrays.</p>
<section id="accessing-timescales">
<h3>Accessing timescales<a class="headerlink" href="#accessing-timescales" title="Link to this heading">¶</a></h3>
<p>Particle timescales (in s) can be accessed through</p>
<blockquote>
<div><p>io.t_ + ${Particle internal name} + _ + ${Process abbreviation}</p>
</div></blockquote>
<p>For example <code class="docutils literal notranslate"><span class="pre">io.t_LepE_sy()</span></code>. <br />
In addition to the processes listed above it is possible to retrieve the acceleration timescale for electrons and protons.</p>
</section>
<section id="injection-of-arbitrary-distributions">
<h3>Injection of arbitrary distributions<a class="headerlink" href="#injection-of-arbitrary-distributions" title="Link to this heading">¶</a></h3>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">AM3 test documentation</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="installAM3.html">Installing pyAM3</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#code-structure">Code structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-settings-grids">Run settings: Grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="#particle-species">Particle species</a></li>
<li class="toctree-l2"><a class="reference internal" href="#source-parameters">Source parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#physics-processes">Physics processes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="processes_details.html">Physics processes details: swichtes and options for speed optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_from_cpp.html">Running from C++</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installAM3.html" title="previous chapter">Installing pyAM3</a></li>
      <li>Next: <a href="processes_details.html" title="next chapter">Physics processes details: swichtes and options for speed optimization</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Annika.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/code_overview.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>